%% Laplace equation de freefem m=1*factor uex= x^3 -2*x*y^2 %%
h=[0.2 0.1 0.05 0.025 0.0125]
err=[0.01 0.0025 0.000625 0.00015625 3.90625e-5]

display('Laplace')
n=4;
for i=1:n-1
    PL2inf(i)=log2(err(i)/err(i+1));
end

PL2inf




%% CN heat equation de freefem m=1*factor, T=3, dt=h %%
h=[0.2 0.1 0.05 0.025 0.0125]
eL2=[0.2933731, 0.0496353, 0.0114092, 0.00279499, 0.000695239]
einfL2=[0.390066, 0.101606, 0.0208001, 0.00500231, 0.00125064]

n=5
for i=1:n-1
    PL2(i)=log2(eL2(i)/eL2(i+1));
    PL2inf(i)=log2(einfL2(i)/einfL2(i+1));
end
display('CN heat equation')
PL2
PL2inf


%% CN heat equation Neuman on border 2 m=80, h=1/m (hmax=0.018), T=3, dt=0.2, 0.1, 0.05, 0.025 %%
eL2=[0.00277706,0.000605764,0.000210822]
for i=1:2
    P(i)=log2(eL2(i)/eL2(i+1))
end
%% dt=h%
e1=0.000982814
e2=0.00021876

e1=0.000246869
e2=6.03889e-005

e1=6.61052e-005
e2=1.73307e-005

p=log2(e1/e2)


%% avec hole
e1=0.146285
e2=0.039237

e1=0.0387469
e2=0.00988092

e1=0.00983485
e2=0.00247218

p=log2(e1/e2)


%dtmax=0.04 h=1/20 m=3


%% coagulationexplicit Tf=2 M=3
%dtmax=0.04 h=1/20 tf=2
err1(1)= 0.000224595
err2(1)= 0.000110758
err1(2)= 0.000249476
err2(2)= 0.000123603
err1(3)= 0.00300021
err2(3)= 0.00147738

%dtmax=0.02 h=1/20
err1(1)= 0.000110758
err2(1)= 5.50096e-05
err1(2)= 0.000123603
err2(2)= 6.15323e-05
err1(3)= 0.00147738
err2(3)= 0.000733241

%dtmax=0.01 0.005 0.0025 h=1/20
err1(1)= 5.50096e-05
err2(1)= 2.74145e-05
err1(2)= 6.15323e-05
err2(2)= 3.07008e-05
err1(3)= 0.000733241
err2(3)= 0.000365287

for i=1:3
    p3(i)=log2(err1(i)/err2(i));
end
p3


%% implicit v1 N+1 des que possible 

err1(1)= 0.00385035
err2(1)= 0.00013105
err1(2)= 0.00363323
err2(2)= 9.68724e-05
err1(3)= 0.0529309
err2(3)= 0.00285551

% err1(1)= 0.0157775
% err2(1)= 0.000535783
% err1(2)= 0.0148665
% err2(2)= 0.000394765
% err1(3)= 0.217225
% err2(3)= 0.011642
for i=1:3
    p3(i)=log2(err1(i)/err2(i));
end
p3


err1(1)= 0.0157775
err2(1)= 0.000535783
err3(1)= 1.59716e-05
err1(2)= 0.0148665
err2(2)= 0.000394765
err3(2)= 2.42143e-05
err1(3)= 0.217225
err2(3)= 0.011642
err3(3)= 0.00134889



%v2 N+1 juste pour system m (U_m^n+1 * Ql) sinon val U^m
%Tf=4 h=1/20
%dt=0.2 0.1 0.5 0.025 
err1(1)= 0.00150687;
err2(1)= 0.000714392;
err3(1)= 0.00034094;
err1(2)= 0.000874431;
err2(2)= 0.000406668;
err3(2)= 0.000190978;
err1(3)= 0.0303668;
err2(3)= 0.014499;
err3(3)= 0.0069710;
for i=1:3
    p3(i)=log2(err1(i)/err2(i));
    p33(i)=log2(err2(i)/err3(i));

end
p3
p33
err1(1)= 0.00150687;
err2(1)= 0.000714392;
err3(1)= 0.00034094;
err1(2)= 0.000874431;
err2(2)= 0.000406668;
err3(2)= 0.000190978;
err1(3)= 0.0303668;
err2(3)= 0.014499;
err3(3)= 0.0069710;


for i=1:3
    p3(i)=log2(err1(i)/err2(i));
    p33(i)=log2(err2(i)/err3(i));

end
p3
p33


